{% extends "base.html" %}
{% block content %}
<div class="container">
    <div class="nav">
  <a href="/">홈</a>
  <a href="/upload">파일 업로드</a>
    </div>
    <h2>작업 목록</h2>
  <table>
    <tr><th>파일명</th><th>상태</th><th>생성</th><th>배치</th><th>진행률</th><th>결과</th></tr>
        {% for job_id, job in job_items %}
        <tr>
            <td style="max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
              <a href="/job/{{ job_id }}" style="text-decoration:none;color:#2563eb;">
                {{ job.file_name or '-' }}
              </a>
            </td>
            <td class="status">{{ job.status }}</td>
            <td>{{ job.created_at }}</td>
            <td>{{ job.batches_done or 0 }} / {{ job.batches_total or '-' }}</td>
            <td>
              {% if job.batches_total %}
                {{ ((job.batches_done or 0) / job.batches_total * 100) | round(0, 'floor') }}%
              {% else %}-{% endif %}
            </td>
            <td>{% if job.status == '완료' %}<a href="/job/{{ job_id }}">결과</a>{% else %}-{% endif %}</td>
        </tr>
        {% endfor %}
    </table>
    {% if not job_items %}<div style="text-align:center; color:#aaa; margin-top:24px;">작업 내역이 없습니다.</div>{% endif %}
</div>
{% endblock %}
